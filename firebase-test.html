<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DTracker Firebase Test</title>
<style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:20px;}</style>
<h1>Firebase Test</h1>
<p id="status">Loading…</p>
<script src="./unregister-sw.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
  import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAredpIvTx0c7uxn23HZoD3YkTgcG4cHbk",
    authDomain: "downtime-tracking-135f6.firebaseapp.com",
    projectId: "downtime-tracking-135f6",
    storageBucket: "downtime-tracking-135f6.firebasestorage.app",
    messagingSenderId: "422856401277",
    appId: "1:422856401277:web:7b10cb426abf816d74ec14",
    measurementId: "G-CJ2F30SYRY"
  };

  const status = document.getElementById('status');
  try {
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    await signInAnonymously(getAuth(app));

    const testRef = doc(db, "pages-health", "hello");
    await setDoc(testRef, { ping: "pong", at: Date.now() }, { merge: true });
    const snap = await getDoc(testRef);
    status.textContent = snap.exists() ? "Firestore OK ✔" : "Firestore read failed";
  } catch (e) {
    status.textContent = "Error: " + (e?.message || e);
    console.error(e);
  }
</script>
</html>
